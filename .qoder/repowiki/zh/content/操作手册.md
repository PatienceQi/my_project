# 操作手册

<cite>
**本文档引用文件**  
- [README.md](file://README.md)
- [软件著作权申请.md](file://软件著作权申请.md)
- [政策法规RAG问答系统操作手册.md](file://政策法规RAG问答系统操作手册.md)
- [frontend/index.html](file://frontend/index.html)
- [frontend/index_graphrag.html](file://frontend/index_graphrag.html)
- [backend/api_server.py](file://backend/api_server.py)
- [scripts/import_policy_data.py](file://scripts/import_policy_data.py)
- [database/[OCR]_华侨经济文化合作试验区.json](file://database/[OCR]_华侨经济文化合作试验区.json)
</cite>

## 更新摘要
**变更内容**  
- 根据前端界面更新，补充了“新建会话”、“清空聊天”和“测试连接”等新功能按钮的操作说明
- 新增了GraphRAG增强模式的功能描述，包括可信度评估、警告提示和来源信息展示
- 增加了“对比RAG方法”功能的使用说明
- 更新了界面功能说明部分，准确反映最新的用户界面元素
- 补充了会话管理功能的详细说明

## 目录
1. [简介](#简介)
2. [系统概述](#系统概述)
3. [安装与配置](#安装与配置)
4. [操作指南](#操作指南)
5. [典型问题示例](#典型问题示例)
6. [常见问题解答](#常见问题解答)
7. [注意事项](#注意事项)

## 简介

本操作手册旨在为最终用户提供一份清晰、易懂的使用指南，帮助用户顺利使用“政策法规RAG问答系统”。该系统结合了大语言模型（LLM）与Neo4j图数据库技术，能够通过自然语言问答的方式，为用户提供政策法规的精准查询、实体关系展示和答案溯源功能。本手册将详细介绍系统的使用步骤、界面功能及注意事项。

## 系统概述

- **软件名称**：政策法规RAG问答系统Demo
- **版本号**：1.0
- **主要功能**：
  - **多模态查询**：用户可通过自然语言输入问题，系统将返回结构化回答。
  - **实体关系展示**：系统基于图数据库，展示政策、条款、机构等实体间的关联。
  - **答案溯源**：所有回答均提供来源信息，包括政策标题、章节及发布机构，确保信息可信。

## 安装与配置

### 运行环境要求

- **硬件环境（推荐）**：
  - CPU：双核以上处理器
  - 内存：最低4GB，推荐8GB
  - 存储：至少500MB可用空间

- **软件环境（推荐）**：
  - 操作系统：Windows 10/11、Linux（如Ubuntu 20.04）或macOS
  - Python 3.8+
  - Neo4j 4.x或5.x
  - 浏览器：Chrome、Edge或Firefox
  - Ollama（可选，用于本地大模型服务）

### 安装与启动步骤

1. **克隆项目**：
   将项目代码克隆或下载至本地，确保目录结构完整。

2. **安装依赖**：
   在项目根目录下运行以下命令，安装Python依赖包：
   ```bash
   pip install -r requirements.txt
   ```

3. **配置环境变量**：
   在项目根目录创建`.env`文件，配置以下内容：
   ```plaintext
   NEO4J_URI=neo4j://localhost:7687
   NEO4J_USERNAME=neo4j
   NEO4J_PASSWORD=password
   LLM_BINDING=ollama
   LLM_MODEL=llama3.2:latest
   LLM_BINDING_HOST=http://120.232.79.82:11434
   ```

4. **启动Neo4j数据库**：
   确保Neo4j服务已启动。可通过Neo4j Desktop或命令行方式运行。

5. **导入政策数据**：
   运行以下脚本，将`database`目录中的JSON数据导入Neo4j：
   ```bash
   python scripts/import_policy_data.py
   ```

6. **启动后端服务**：
   启动Flask后端API服务：
   ```bash
   python backend/api_server.py
   ```
   服务默认运行在`http://localhost:5000`。

7. **启动前端应用**：
   打开浏览器，直接访问`frontend/index.html`文件，或通过HTTP服务器访问。

**Section sources**
- [README.md](file://README.md#L1-L252)
- [软件著作权申请.md](file://软件著作权申请.md#L1-L190)
- [政策法规RAG问答系统操作手册.md](file://政策法规RAG问答系统操作手册.md#L1-L129)

## 操作指南

### 1. 界面功能说明

系统前端界面简洁直观，主要包含以下区域：

- **输入区域**：位于页面底部，包含一个文本输入框和“发送”按钮，用于输入您的问题。
- **聊天区域**：位于页面中央，动态显示用户提问和系统返回的回答。
- **状态区域**：位于页面右上角，显示“已连接”或“未连接”，用于指示前端是否成功连接到后端服务。
- **控制按钮区**：位于聊天区域上方，包含“新建会话”、“清空聊天”和“测试连接”等操作按钮。
- **会话信息**：位于页面左上角，显示当前会话ID，便于用户追踪对话历史。

### 2. 提问与查看答案

1. **打开index.html文件**：使用浏览器打开`frontend/index.html`。
2. **确保后端服务已启动**：确认`backend/api_server.py`正在运行。
3. **输入问题**：在输入框中输入关于政策法规的问题，例如：“外商投资有哪些优惠？”
4. **发送问题**：点击“发送”按钮或按回车键提交。
5. **查看系统响应**：
   - **答案显示区**：系统将返回一段自然语言回答，解释问题内容。
   - **引用来源**：回答下方会列出相关政策法规的标题、章节、条款内容及发布机构。
   - **相关实体**：系统会提取并展示与问题相关的实体（如政策、机构）及其关系。

### 3. 界面元素详解

- **问题输入区**：支持自然语言输入，建议问题表述清晰、具体。
- **答案显示区**：以“回答：”开头，内容由大模型生成，语言通俗易懂。
- **引用文献列表**：以“相关政策法规：”开头，以列表形式展示信息来源，增强回答可信度。
- **状态提示**：若显示“未连接”，请检查后端服务是否正常运行。
- **新建会话**：点击此按钮可创建新的对话会话，系统会生成唯一的会话ID并显示在会话信息区。
- **清空聊天**：点击此按钮可清除当前聊天记录，但会保留欢迎消息。
- **测试连接**：点击此按钮可手动测试前端与后端服务的连接状态，并在聊天区域显示测试结果。

### 4. GraphRAG增强功能

系统支持GraphRAG增强模式，提供更智能的问答体验：

- **可信度评估**：系统会为回答提供可信度评分，以进度条形式直观展示。
- **警告提示**：当系统检测到潜在问题（如信息不足或可能存在幻觉）时，会显示警告信息。
- **来源信息**：详细展示回答所依据的文档或图谱实体，包括相关度评分。
- **处理时间**：显示问题处理所用的时间，帮助用户了解系统性能。

### 5. 对比RAG方法功能

系统提供传统RAG与GraphRAG方法的对比功能：

1. 在输入框中输入问题。
2. 点击“对比RAG方法”按钮。
3. 系统将并列展示两种方法的回答结果，包括：
   - 传统RAG模式的回答
   - GraphRAG模式的回答
   - GraphRAG的可信度评分
   - GraphRAG的警告信息
4. 用户可根据对比结果评估不同方法的优劣。

**Section sources**
- [frontend/index.html](file://frontend/index.html#L0-L253)
- [frontend/index_graphrag.html](file://frontend/index_graphrag.html#L0-L822)
- [backend/api_server.py](file://backend/api_server.py#L0-L119)
- [backend/api_server.py](file://backend/api_server.py#L495-L527)
- [backend/api_server.py](file://backend/api_server.py#L696-L732)

## 典型问题示例

以下为系统支持的典型问题及预期响应示例：

| 用户问题 | 预期响应摘要 |
|--------|------------|
| “华侨经济文化合作试验区有哪些优惠政策？” | 系统返回试验区相关政策摘要，引用具体政策文件标题和章节，并列出发布机构。 |
| “汕华管委规第一章第一条的主要内容是什么？” | 系统直接返回该条款的原文内容，并标注其所属政策文件。 |
| “外商投资在试验区享有哪些便利？” | 系统整合多条政策信息，生成综合回答，并列出所有引用的政策条文。 |

**Section sources**
- [软件著作权申请.md](file://软件著作权申请.md#L1-L190)
- [政策法规RAG问答系统操作手册.md](file://政策法规RAG问答系统操作手册.md#L1-L129)

## 常见问题解答

1. **系统无法连接后端服务怎么办？**
   - 确认后端服务`api_server.py`已启动。
   - 检查浏览器控制台是否有跨域或连接错误。

2. **提问后没有返回答案？**
   - 确认数据已通过`import_policy_data.py`成功导入Neo4j。
   - 检查问题是否与现有政策内容相关，尝试更换提问方式。

3. **如何验证系统功能？**
   可运行测试脚本验证各服务连接：
   ```bash
   python scripts/test_neo4j_connection.py
   python scripts/test_ollama_connection.py
   python scripts/test_backend_response.py
   ```

4. **如何查看系统状态？**
   - 系统启动后会自动检查连接状态。
   - 可点击“测试连接”按钮手动测试。
   - 系统状态信息会显示在右上角的状态区域。

**Section sources**
- [README.md](file://README.md#L1-L252)
- [scripts/test_backend_response.py](file://scripts/test_backend_response.py#L0-L20)
- [scripts/test_neo4j_connection.py](file://scripts/test_neo4j_connection.py#L0-L24)

## 注意事项

- 本系统为演示版本，数据覆盖范围有限，回答仅供参考，不构成法律意见。
- 为获得更准确的回答，请尽量使用清晰、具体的提问方式，避免模糊或宽泛的问题。
- 如需用于生产环境，建议优化大模型配置、扩展数据集并增强错误处理机制。

**Section sources**
- [政策法规RAG问答系统操作手册.md](file://政策法规RAG问答系统操作手册.md#L1-L129)
- [软件著作权申请.md](file://软件著作权申请.md#L1-L190)